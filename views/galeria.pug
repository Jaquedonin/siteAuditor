extends layout.pug
block content
    main#galeria.d-flex.flex-column.align-content-stretch
        header#mapa-header
            nav.navbar.navbar-expand-lg.navbar-dark.navbar-fixed-top
                .container
                    a.navbar-brand.col-4(href='#page-top') MAPA COLABORATIVO CIDADÃO
                    #logo.navbar-brand.col-4
                        img(src="/images/logo_tce.png")
                        span Tribunal de Contas do <br/> Estado da Paraíba
                    button.navbar-toggler.collapsed(type='button', data-toggle='collapse', data-target='#navbar', aria-expanded='false', aria-controls='navbar', aria-label='Toggle navigation')
                        span.sr-only Toggle navigation
                        span.navbar-toggler-icon
                    #navbar.col-4.collapse.navbar-collapse
                        ul.navbar-nav.ml-auto
                            li.nav-item
                                a.nav-link Como participar
                            li.nav-item#login
                                if user
                                    a.nav-link(href="/dashboard") 
                                        span Gerenciador
                                else
                                    a.nav-link(href='/auth') Login
                            li.nav-item
                                a.nav-link Sobre
        nav.navbar.navbar-expand-lg#galeria-navbar 
            a#voltar-galeria(href="/")
                i.fas.fa-arrow-left
            #miniatura
                p=cidade.nome
                script.
                    $("##{cidade.codigo}").attr("class", "selected")
            div.col
                form(method="POST" action="/galeria/" + cidade.codigo + "/" + (escola.id ? escola.id : "todas")) 
                    .row#inputs-galeria
                        .col-3
                            input#select-escola(type='text' name='escola' placeholder="Pesquisar escolas" value=escola.nome).form-control.form-control-sm
                        .col-3
                            .row
                                .input-group
                                    input.form-control.form-control-sm#pesquisar(name="termo" placeholder="Pesquisar" value=busca?busca:"")
                                    input(type="hidden" name="cidade_id" value=cidade.codigo)
                                    .input-group-append
                                        i.input-group-text.fas.fa-search 
                                input(type="submit" style="display:none")    
                    .row
                        .col
                            if categorias            
                                ul.navbar-nav#categorias
                                    each categoria, index in categorias
                                        li(data-slide-to=index data-target="#categoria" data-categoria=categoria.descricao class= categoria.selected ? "nav-item selected" : "nav-item")
                                            a.nav-link=categoria.descricao
                        .col#col-limpar-pesquisa
                            if busca
                                a#limpar-pesquisa.btn.btn-danger(href="") Limpar pesquisa
        #categoria.carousel.slide(data-ride='carousel' data-interval="false")       
            .carousel-inner
                each categoria, index in categorias
                    .carousel-item
                        .row
                            - var destaque = true
                            if videos 
                                each video in videos[index]
                                    - var classe = destaque ? ".video.destaque.col-12" : ".video.col-4";
                                    - var title = destaque ? video.titulo : video.titulo.substring(0,30);
                                    - var description =  destaque ? video.descricao : video.descricao.substring(0,80)
                                    div(class=classe)
                                        .row(onclick="visualizarVideo("+video.id+")")
                                            .preview.col-6(style="background-image: url("+video.thumb+")")
                                                i.fa.fa-play
                                            .info.col-6
                                                .autor=video.author
                                                .titulo
                                                    b=title
                                                .descr=description
                                    - destaque = false                        
                                
block modal
    #visualizar-video.modal(tabindex='-1', role='dialog')
    script(type='text/javascript', src='/javascripts/galeria.js')